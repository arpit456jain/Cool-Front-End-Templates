// For license information, see `https://assets.adobedtm.com/d4d114c60e50/f3fbfbe0e7ca/34450aade553/RCbb47518ad08d43699044c6ef46f39ebb-file.js`.
window._sophiaLoadedPromise=new Promise((function(e){var n=window.adobeIMS,o=o||function(e){function t(){return window.console&&window.console.log&&window.console.error}var a="[Sophia]",r=function(){},i="head",s={ActionId:"",CampaignId:"",ContainerId:"",ControlGroupId:"",TreatmentId:"",VariationId:"",CardId:"",SurfaceId:""},c=function(e,n,o){var t=performance.now(),a=new XMLHttpRequest;a.onreadystatechange=function(){if(a.readyState==XMLHttpRequest.DONE){var o=performance.now();h.log("Total time taken for fetching response for: ",e,o-t," milliseconds."),n(a)}},a.open("GET",e,!0),o&&o.forEach((function(e){a.setRequestHeader(e.key,e.val)})),h.log("Sending request: ",e),a.send()},d=function(e){var n=document.implementation.createHTMLDocument();return n.body.innerHTML=e,n},l=function(e){h.log("Got response: "+e);var n=document.querySelectorAll(o.conf.sourceSelector);if(n&&n.length>0){h.log("Found source..",n);var t=d(e);if(t){h.log("Found target..",t);var a=t.querySelectorAll(o.conf.targetSelector);a&&a.length>0&&(h.log("replacing the content on page..."),n[0].innerHTML=a[0].innerHTML)}}o.endTime=performance.now(),h.log("Total time taken for fetching experience from Sophia and replacing XF: ",o.endTime-o.startTime," milliseconds.")},u=function(e){if(h.log("Head card",e),e.data){var n=document.getElementsByTagName("head")[0],o=document.createElement("script");o.type="text/javascript",o.text=e.data,n.appendChild(o)}},p=function(e){l(e.data),f(e.containerAnalyticsData)},f=function(n){var o={};o.ActionId=n.actionBlockId,o.CampaignId=n.campaignId,o.ContainerId=n.containerId,o.ControlGroupId=n.controlGroupId,o.TreatmentId=n.treatmentId,o.VariationId=n.variationId,o.CardId="",o.SurfaceId=e.surfaceID,window.digitalData.sophiaResponse[window.digitalData.sophiaResponse.length]=o},g=function(n){if(200==n.status){h.log("Got response from Sophia: ",n.responseText);var t=JSON.parse(n.responseText);if(t.surfaces&&t.surfaces[e.surfaceID]&&t.surfaces[e.surfaceID].containers&&t.surfaces[e.surfaceID].containers.length>0){var a=t.surfaces[e.surfaceID].containers;window.digitalData.sophiaResponse=[],o.result.doesResponseExist=a.length>0,Object.keys(a).forEach((function(e){i==a[e].containerLabel?u(a[e]):p(a[e]),o.result[e]={label:a[e].containerLabel,responseEmpty:null==a[e].data}}))}}else h.error("Error response: ",n.responseText," status = ",n.status);o.result.status=n.status,o.resultCbk&&o.resultCbk(o.result)},m=function(t){var a=e.fetchcontentURI[e.env],r=Object.assign({surfaceId:e.surfaceID,clientCode:e.clientCode},o.contextualParams),i=(r=Object.entries(r).map((function(e){return encodeURIComponent(e[0])+"="+encodeURIComponent(e[1])}))).join("&"),d=n&&n.getAccessToken()?n.getAccessToken():e.accessToken,l=[{key:"x-api-key",val:e.apiKey},{key:"Content-Type",val:"application/json"},{key:"Authorization",val:"Bearer "+d}];window.digitalData=window.digitalData||{sophiaResponse:[s]},c(encodeURI(a+"?"+i),t,l)},w=function(){var n={log:r,error:r};return t()&&(n.error=function(){window.console.error.apply(window.console,[].concat.apply([a],arguments))},e.debug&&(n.log=function(){window.console.log.apply(window.console,[].concat.apply([a],arguments))})),n},I=function(n,t){o.startTime=performance.now(),this.result={doesResponseExist:!1},this.resultCbk=t,this.conf=Object.assign(e,n||{}),m(g)},h=w();return{conf:e,loadExperienceFromSophia:I}}({sourceSelector:".experiencefragment",targetSelector:".root.responsivegrid",surfaceID:"engineering_demo",env:"stage",apiKey:"adobedotcom2",clientCode:"adobe.com",accessToken:"---- Replace with test access token if testing without adobeIMS ----",fetchcontentURI:{stage:"https://p13n-stage.adobe.io/psdk/v2/content",prod:"https://p13n.adobe.io/psdk/v2/content"},debug:!1});window._sophia=o||"unknown",e(window._sophia)}));